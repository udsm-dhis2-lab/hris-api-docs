"use strict";(self.webpackChunkhris_api_docs=self.webpackChunkhris_api_docs||[]).push([[153],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=d(n),h=r,m=c["".concat(l,".").concat(h)]||c[h]||u[h]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3612:function(e,t,n){n.r(t),n.d(t,{default:function(){return u},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return d}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={id:"api-introduction",title:"HRHIS API Introduction",sidebar_label:"Introduction to HRHIS APIs"},l={unversionedId:"developers/api-introduction",id:"developers/api-introduction",isDocsHomePage:!1,title:"Introduction to HRHIS APIs",description:"The HRHIS API is organized around. Our API has predictable resource-oriented URLs, accepts form-encoded request bodies, returns JSON-encoded responses, and uses standard HTTP response codes, authentication, and verbs.",source:"@site/docs/developers/apiIntroduction.md",sourceDirName:"developers",slug:"/developers/api-introduction",permalink:"/hris-api-docs/docs/developers/api-introduction",editUrl:"https://github.com/udsm-dhis2-lab/hris-api-docs/blob/main/docs/developers/apiIntroduction.md",version:"current",sidebar_label:"Introduction to HRHIS APIs",frontMatter:{id:"api-introduction",title:"HRHIS API Introduction",sidebar_label:"Introduction to HRHIS APIs"},sidebar:"docs",previous:{title:"Web API",permalink:"/hris-api-docs/docs/developers/basics"},next:{title:"Forms",permalink:"/hris-api-docs/docs/developers/metadata/forms"}},d=[{value:"Setting Up HRHIS",id:"setting-up-hrhis",children:[{value:"Setting up docker environment for development",id:"setting-up-docker-environment-for-development",children:[]}]},{value:"Authentications",id:"authentications",children:[{value:"Basic Authentication",id:"basic-authentication",children:[]},{value:"OAuth2",id:"oauth2",children:[]}]},{value:"Errors",id:"errors",children:[{value:"Attributes",id:"attributes",children:[]},{value:"Handling errors",id:"handling-errors",children:[]},{value:"Expanding Responses",id:"expanding-responses",children:[]},{value:"Metadata",id:"metadata",children:[]},{value:"Pagination",id:"pagination",children:[]},{value:"Request IDs",id:"request-ids",children:[]}]}],p={toc:d};function u(e){var t=e.components,s=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The HRHIS API is organized around. Our API has predictable resource-oriented URLs, accepts form-encoded request bodies, returns JSON-encoded responses, and uses standard HTTP response codes, authentication, and verbs."),(0,o.kt)("h2",{id:"setting-up-hrhis"},"Setting Up HRHIS"),(0,o.kt)("p",null,"HRHIS uses docker from development to deployment."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"When setting up HRHIS for both development and production, we will setup mainly 3 services used by HRHIS.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"PostgreSQL as our data persistance layer."),(0,o.kt)("li",{parentName:"ul"},"Nginx as the reverse proxy and webserver."),(0,o.kt)("li",{parentName:"ul"},"Redis as an in memory session storage database."),(0,o.kt)("li",{parentName:"ul"},"NodeJs as our underlying API application runtime environment.")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"HRHIS uses environmental variables to manage some runtime resources that can not be directly built in production port and at the bare minimum, the following environment variables are needed")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"SERVER_PORT. The port in which your NestJs application listens on."),(0,o.kt)("li",{parentName:"ul"},"DB_CONNECTION. TypeORM database connection name."),(0,o.kt)("li",{parentName:"ul"},"DB_HOST. PostgreSQL database host."),(0,o.kt)("li",{parentName:"ul"},"DB_PORT. PostgreSQL database port."),(0,o.kt)("li",{parentName:"ul"},"DB_USERNAME. PostgreSQL database username."),(0,o.kt)("li",{parentName:"ul"},"POSTGRES_PASSWORD. PostgreSQL database password."),(0,o.kt)("li",{parentName:"ul"},"POSTGRES_USER. PostgreSQL database name.")),(0,o.kt)("h3",{id:"setting-up-docker-environment-for-development"},"Setting up docker environment for development"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Steps")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Install ",(0,o.kt)("a",{parentName:"p",href:"https://www.docker.com/"},"Docker"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Clone the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/udsm-dhis2-lab/hris-core"},"repo"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"cd into your clone repository")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Create ",(0,o.kt)("inlineCode",{parentName:"p"},"Dockerfile")," file"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'FROM node:14.16.1-alpine3.12\nRUN apk add --no-cache tzdata\nRUN apk add --no-cache --virtual .gyp python3 make gcc g++\nENV TZ Africa/Dar_es_Salaam\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone\nRUN mkdir /home/app\nWORKDIR /home/app\nCOPY ["package.json", "package-lock.json","nodemon.json", "nodemon-debug.json","config.example.json" ,"tsconfig.json", "tsconfig.build.json","./"]\nRUN npm install && apk del .gyp\nCOPY ["src","./src"]\n'))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Create ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," file"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"version: '3.2'\n\nservices:\n  redis:\n    image: redis\n    restart: always\n    healthcheck:\n      test: 'exit 0'\n    networks:\n    - hrhis-network\n\n  postgres:\n    image: postgres:14-alpine3.15\n    command: postgres -c 'max_connections=1000'\n    shm_size: 10g\n    healthcheck:\n       test: [ \"CMD\", \"pg_isready\", \"-q\", \"-d\", \"${POSTGRES_DB}\", \"-U\", \"${POSTGRES_USER}\" ]\n       timeout: 45s\n       interval: 10s\n       retries: 10\n    env_file: .env\n    restart: always\n    volumes:\n      - postdb-data:/var/lib/postgresql/data\n    networks:\n    - hrhis-network\n\n  nginx:\n    image: nginx:1.17.9-alpine\n    ports:\n      - <YOUR ENV SERVER PORT>:8080\n    healthcheck:\n      test: ['CMD', 'curl', '-f', 'http://localhost:8080/']\n      timeout: 20s\n    restart: always\n    env_file: .env\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n  api:\n    image: hris/api\n    build: .\n    restart: always\n    env_file: .env\n    healthcheck:\n      test: ['CMD', 'curl', '-f', 'http://localhost:<YOUR ENV SERVER PORT>/']\n      timeout: 20s\n    depends_on:\n      - postgres\n    command: npm run start:dev\n    networks:\n    - hrhis-network\n    volumes:\n      - ./src:/home/app/src\n      - ./files:/home/app/files\nvolumes:\n  postdb-data:\n    driver: local\nnetworks:\n  hrhis-network:\n\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Change the upstream port in ",(0,o.kt)("inlineCode",{parentName:"p"},"nginx.conf")," file to match ",(0,o.kt)("inlineCode",{parentName:"p"},"YOUR ENV SERVER PORT"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose up"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"The following screen should appear"))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"img alt",src:n(3052).Z})),(0,o.kt)("h4",{id:""}),(0,o.kt)("h2",{id:"authentications"},"Authentications"),(0,o.kt)("p",null,"The HRHIS4 Web API supports two protocols for authentication, Basic\nAuthentication and OAuth 2. You can verify and get information about the\ncurrently authenticated user by making a GET request to the following\nURL:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/api/me\n")),(0,o.kt)("h3",{id:"basic-authentication"},"Basic Authentication"),(0,o.kt)("p",null,"Basic authentication\nis a technique for clients to send login credentials over HTTP to a web\nserver. The username is appended with a colon and respective password, Base64-encoded, prefixed Basic and supplied as the value\nof the ",(0,o.kt)("em",{parentName:"p"},"Authorization")," HTTP header. More formally that is:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Authorization: Basic base64encode(username:password)\n")),(0,o.kt)("p",null,"Most network-aware development environments provide support for Basic\nauthentication, such as ",(0,o.kt)("em",{parentName:"p"},"Apache HttpClient")," and ",(0,o.kt)("em",{parentName:"p"},"Spring RestTemplate"),".\nAn important note is that this authentication scheme provides no security\nsince the username and password are sent in plain text and can be easily\nobserved by an attacker. Using Basic is recommended only if the server is\nusing SSL/TLS (HTTPS) to encrypt communication with clients. Consider this\na hard requirement in order to provide secure interactions with the Web\nAPI."),(0,o.kt)("h3",{id:"oauth2"},"OAuth2"),(0,o.kt)("p",null,"HRHIS supports the ",(0,o.kt)("em",{parentName:"p"},"OAuth2")," authentication protocol. OAuth2 is an open\nstandard for authorization which allows third-party clients to\nconnect on behalf of a HRHIS4 user and get a reusable ",(0,o.kt)("em",{parentName:"p"},"bearer token")," for\nsubsequent requests to the Web API. HRHIS4 does not support fine-grained\nOAuth2 roles but rather provides applications access based on user roles\nof the HRHIS4 user."),(0,o.kt)("p",null,"All API requests must be made over HTTPS. Calls made over plain HTTP will fail. API requests without authentication will also fail."),(0,o.kt)("h2",{id:"errors"},"Errors"),(0,o.kt)("p",null,"HRHIS uses conventional HTTP response codes to indicate the success or failure of an API request. In general: Codes in the 2xx range indicate success. Codes in the 4xx range indicate an error that failed given the information provided (e.g.Unauthorized, Forbidden, Method Not Allowed, Request Timeout etc.). Codes in the 5xx range indicate an error with HRHIS' servers (these are rare)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"{\n  '100': 'Continue',\n  '101': 'Switching Protocols',\n  '102': 'Processing',\n  '103': 'Early Hints',\n  '200': 'OK',\n  '201': 'Created',\n  '202': 'Accepted',\n  '203': 'Non-Authoritative Information',\n  '204': 'No Content',\n  '205': 'Reset Content',\n  '206': 'Partial Content',\n  '207': 'Multi-Status',\n  '208': 'Already Reported',\n  '226': 'IM Used',\n  '300': 'Multiple Choices',\n  '301': 'Moved Permanently',\n  '302': 'Found',\n  '303': 'See Other',\n  '304': 'Not Modified',\n  '305': 'Use Proxy',\n  '307': 'Temporary Redirect',\n  '308': 'Permanent Redirect',\n  '400': 'Bad Request',\n  '401': 'Unauthorized',\n  '402': 'Payment Required',\n  '403': 'Forbidden',\n  '404': 'Not Found',\n  '405': 'Method Not Allowed',\n  '406': 'Not Acceptable',\n  '407': 'Proxy Authentication Required',\n  '408': 'Request Timeout',\n  '409': 'Conflict',\n  '410': 'Gone',\n  '411': 'Length Required',\n  '412': 'Precondition Failed',\n  '413': 'Payload Too Large',\n  '414': 'URI Too Long',\n  '415': 'Unsupported Media Type',\n  '416': 'Range Not Satisfiable',\n  '417': 'Expectation Failed',\n  '418': \"I'm a Teapot\",\n  '421': 'Misdirected Request',\n  '422': 'Unprocessable Entity',\n  '423': 'Locked',\n  '424': 'Failed Dependency',\n  '425': 'Too Early',\n  '426': 'Upgrade Required',\n  '428': 'Precondition Required',\n  '429': 'Too Many Requests',\n  '431': 'Request Header Fields Too Large',\n  '451': 'Unavailable For Legal Reasons',\n  '500': 'Internal Server Error',\n  '501': 'Not Implemented',\n  '502': 'Bad Gateway',\n  '503': 'Service Unavailable',\n  '504': 'Gateway Timeout',\n  '505': 'HTTP Version Not Supported',\n  '506': 'Variant Also Negotiates',\n  '507': 'Insufficient Storage',\n  '508': 'Loop Detected',\n  '509': 'Bandwidth Limit Exceeded',\n  '510': 'Not Extended',\n  '511': 'Network Authentication Required',\n}\n")),(0,o.kt)("p",null,"Some 4xx errors that could be handled programmatically (e.g. Bad Request, Payload Too Large) include an error code that briefly explains the error reported."),(0,o.kt)("h3",{id:"attributes"},"Attributes"),(0,o.kt)("h4",{id:"type"},"type"),(0,o.kt)("p",null,"string\nThe type of error returned. One of api_error, or invalid_request_error"),(0,o.kt)("h4",{id:"code"},"code"),(0,o.kt)("p",null,"string\nFor some errors that could be handled programmatically, a short string indicating the error code reported."),(0,o.kt)("h4",{id:"decline_code"},"decline_code"),(0,o.kt)("p",null,"string"),(0,o.kt)("h4",{id:"message"},"message"),(0,o.kt)("p",null,"string\nA human-readable message providing more details about the error. For ..., these messages can be shown to your users."),(0,o.kt)("h4",{id:"param"},"param"),(0,o.kt)("p",null,"string\nIf the error is parameter-specific, the parameter related to the error. For example, you can use this to display a message near the correct form field."),(0,o.kt)("h3",{id:"handling-errors"},"Handling errors"),(0,o.kt)("p",null,"Our Client libraries raise exceptions for many reasons, such as invalid parameters, authentication errors, and network unavailability. We recommend writing code that gracefully handles all possible API exceptions."),(0,o.kt)("h3",{id:"expanding-responses"},"Expanding Responses"),(0,o.kt)("p",null,"Many objects allow you to request additional information as an expanded response by using the expand request parameter. This parameter is available on all API requests, and applies to the response of that request only. Responses can be expanded in two ways."),(0,o.kt)("h3",{id:"metadata"},"Metadata"),(0,o.kt)("p",null,"Updateable HRHIS objects\u2014including Account, Forms, Fields, Field options, Organization units have a metadata parameter. You can use this parameter to attach key-value data to these Stripe objects."),(0,o.kt)("p",null,"You can specify up to 50 keys, with key names up to 40 characters long and values up to 500 characters long."),(0,o.kt)("p",null,"Metadata is useful for storing additional, structured information on an object. As an example, you could assign fields in a form and corresponding unique identifier from your system on a Stripe Customer object. Metadata is not used by HRHIS\u2014for example, not used to authorize or decline a charge\u2014and won't be seen by your users unless you choose to show it to them."),(0,o.kt)("p",null,"Some of the objects listed above also support a description parameter. You can use the description parameter to annotate a charge\u2014with, for example, a human-readable description like 2 shirts for ",(0,o.kt)("a",{parentName:"p",href:"mailto:test@example.com."},"test@example.com.")," Unlike metadata, description is a single string, and your users may see it (e.g., in email receipts Stripe sends on your behalf)."),(0,o.kt)("p",null,"Do not store any sensitive information (bank account numbers, card details, etc.) as metadata or in the description parameter."),(0,o.kt)("h3",{id:"pagination"},"Pagination"),(0,o.kt)("p",null,'All top-level API resources have support for bulk fetches via "list" API methods. For instance, you can list records, list something , and list something. These list API methods share a common structure, taking at least these three parameters: limit, starting_after, and ending_before.'),(0,o.kt)("p",null,"HRHIS utilizes cursor-based pagination via the starting_after and ending_before parameters. Both parameters take an existing object ID value (see below) and return objects in reverse chronological order. The ending_before parameter returns objects listed before the named object. The starting_after parameter returns objects listed after the named object. These parameters are mutually exclusive -- only one of starting_after orending_before may be used."),(0,o.kt)("h4",{id:"parameters"},"Parameters"),(0,o.kt)("p",null,"limit\noptional, default is 10\nA limit on the number of objects to be returned, between 1 and 100."),(0,o.kt)("p",null,"starting_after\noptional\nA cursor for use in pagination. starting_after is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with obj_foo, your subsequent call can include starting_after=obj_foo in order to fetch the next page of the list."),(0,o.kt)("p",null,"ending_before\noptional\nA cursor for use in pagination. ending_before is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with obj_bar, your subsequent call can include ending_before=obj_bar in order to fetch the previous page of the list."),(0,o.kt)("p",null,'List Response Format\nobject\nstring, value is "list"\nA string describing the object type returned.'),(0,o.kt)("p",null,"data\narray\nAn array containing the actual response elements, paginated by any request parameters."),(0,o.kt)("p",null,"has_more\nboolean\nWhether or not there are more elements available after this set. If false, this set comprises the end of the list."),(0,o.kt)("p",null,"url\nstring\nThe URL for accessing this list."),(0,o.kt)("h3",{id:"request-ids"},"Request IDs"),(0,o.kt)("p",null,"Each API request has an associated request identifier. You can find this value in the response headers, under Request-Id. You can also find request identifiers in the URLs of individual request logs in your Dashboard. If you need to contact us about a specific request, providing the request identifier will ensure the fastest possible resolution."))}u.isMDXComponent=!0},3052:function(e,t,n){t.Z=n.p+"assets/images/nestjs_logs-1a123d2a90a11b8f91886b6f5a281d5d.png"}}]);